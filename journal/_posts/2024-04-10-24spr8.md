---
layout: post
title: Closing the Loop
use_math: true
category: journal
---

This post covers work from 04/09 to 04/19. I worked with Nathaniel to try to close the loop by implementing a basic optimization script that can send commands back to the EPICS server. Additionally, we submitted the synthetic data paper to ar$\chi$iv and Journal of Plasma Physics as well.

# Updated Oprimization Script
Changes: 
- Placement of constants in  `constants.py` so that the script doesn't need to be directly edited
- Incorporated Waveplate information by fitting linear regression to $\cos(\theta - \theta_0)^2$ to establish proper mapping of diode to waveplate data
- Added flags for `MANUAL_MODE` so that we can control whether the opimization runs automatically or manually.

## 04/11 Preliminary Analysis
I collected data with Nathaniel today, but there are some issues with the data.

1. The Pspec Data didn't get saved, even though the data server was running. 

2. The Pre-Pulse Looping program didn't appear to be running. This can be seen in the following figure taken from the Looping Controls data (where the PP WP is stuck at 4 degrees):
   
![9a5e87b2-46ec-46c3-898f-cbc7927d9a8b](https://github.com/ronak-n-desai/ronak-n-desai.github.io/assets/98538788/ba1f99dc-30e7-40df-9a6d-668e195843b2)

Now, the `reduced_max` variable is absent from the DIODE data and the `reduced_mean` value seems to be nonsense

![image](https://github.com/ronak-n-desai/ronak-n-desai.github.io/assets/98538788/f743e416-69ab-4fea-95d0-d1168c483a8a)

On the other hand, there is this new term called `global_peak5` which appears to roughly move up and down like an intensity would:

![image](https://github.com/ronak-n-desai/ronak-n-desai.github.io/assets/98538788/1da53765-a5b3-47a9-afd6-2fc2d51e5de8)

![image](https://github.com/ronak-n-desai/ronak-n-desai.github.io/assets/98538788/f403c6ad-4175-4cf3-8caa-026d17586875)

However, I'm not sure what this is and how it makes sense if the waveplate looping program is not updating the PP angle.

3. In the one of the above figures, the MP Waveplate had a smaller step size at an angle measure of 20 degrees (which corresponds to the calibrated angle for maximum intensity) and a larger step size at a measure of 40 degrees. This should actually be the exact opposite. I presume the same could apply to the PP if it had been looping properly.

With this said, there appears to be some things that went well:

1. The Nozzle Focus is looping correctly:

![image](https://github.com/ronak-n-desai/ronak-n-desai.github.io/assets/98538788/47cad2e4-969b-46ca-8c00-5eb7ef295e47)

2. The E-Spec Data appears to make sense

![image](https://github.com/ronak-n-desai/ronak-n-desai.github.io/assets/98538788/9d277e61-0c06-4136-a6f4-bcd743a3f4e1)





# JPP Paper
...
